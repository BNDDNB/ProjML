{"nbformat_minor": 2, "cells": [{"execution_count": 1, "cell_type": "code", "source": "import org.apache.spark.sql.Encoders\ncase class flight(DayofMonth:Int, DayOfWeek:Int, Carrier:String, OriginAirportID:Int, DestAirportID:Int, DepDelay:Int, ArrDelay:Int)\nval flightSchema = Encoders.product[flight].schema\nval flights = spark.read.schema(flightSchema).option(\"header\",\"true\").csv(\"wasb:///data/raw-flight-data.csv\")\nflights.show()", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Starting Spark application\n"}, {"output_type": "display_data", "data": {"text/plain": "<IPython.core.display.HTML object>", "text/html": "<table>\n<tr><th>ID</th><th>YARN Application ID</th><th>Kind</th><th>State</th><th>Spark UI</th><th>Driver log</th><th>Current session?</th></tr><tr><td>8</td><td>application_1516029531965_0012</td><td>spark</td><td>idle</td><td><a target=\"_blank\" href=\"http://hn1-spk012.zi1mhgvoalbuxhlxjrtncoyukd.bx.internal.cloudapp.net:8088/proxy/application_1516029531965_0012/\">Link</a></td><td><a target=\"_blank\" href=\"http://10.0.0.7:30060/node/containerlogs/container_1516029531965_0012_01_000001/livy\">Link</a></td><td>\u2714</td></tr></table>"}, "metadata": {}}, {"output_type": "stream", "name": "stdout", "text": "SparkSession available as 'spark'.\n+----------+---------+-------+---------------+-------------+--------+--------+\n|DayofMonth|DayOfWeek|Carrier|OriginAirportID|DestAirportID|DepDelay|ArrDelay|\n+----------+---------+-------+---------------+-------------+--------+--------+\n|        19|        5|     DL|          11433|        13303|      -3|       1|\n|        19|        5|     DL|          14869|        12478|       0|      -8|\n|        19|        5|     DL|          14057|        14869|      -4|     -15|\n|        19|        5|     DL|          15016|        11433|      28|      24|\n|        19|        5|     DL|          11193|        12892|      -6|     -11|\n|        19|        5|     DL|          10397|        15016|      -1|     -19|\n|        19|        5|     DL|          15016|        10397|       0|      -1|\n|        19|        5|     DL|          10397|        14869|      15|      24|\n|        19|        5|     DL|          10397|        10423|      33|      34|\n|        19|        5|     DL|          11278|        10397|     323|     322|\n|        19|        5|     DL|          14107|        13487|      -7|     -13|\n|        19|        5|     DL|          11433|        11298|      22|      41|\n|        19|        5|     DL|          11298|        11433|      40|      20|\n|        19|        5|     DL|          11433|        12892|      -2|      -7|\n|        19|        5|     DL|          10397|        12451|      71|      75|\n|        19|        5|     DL|          12451|        10397|      75|      57|\n|        19|        5|     DL|          12953|        10397|      -1|      10|\n|        19|        5|     DL|          11433|        12953|      -3|     -10|\n|        19|        5|     DL|          10397|        14771|      31|      38|\n|        19|        5|     DL|          13204|        10397|       8|      25|\n+----------+---------+-------+---------------+-------------+--------+--------+\nonly showing top 20 rows"}], "metadata": {"collapsed": false}}, {"execution_count": 2, "cell_type": "code", "source": "flights.describe().show()", "outputs": [{"output_type": "stream", "name": "stdout", "text": "+-------+-----------------+------------------+-------+------------------+------------------+-----------------+-----------------+\n|summary|       DayofMonth|         DayOfWeek|Carrier|   OriginAirportID|     DestAirportID|         DepDelay|         ArrDelay|\n+-------+-----------------+------------------+-------+------------------+------------------+-----------------+-----------------+\n|  count|          2719418|           2719418|2719418|           2719418|           2719418|          2691974|          2690385|\n|   mean|15.79747468024408|3.8983907586108497|   null| 12742.26441172339|12742.455345592329|10.53686662649788| 6.63768791455498|\n| stddev|8.799860168985367|1.9859881390373617|   null|1501.9729397025808|1501.9692528927785|36.09952806643081|38.64881489390021|\n|    min|                1|                 1|     9E|             10140|             10140|              -63|              -94|\n|    max|               31|                 7|     YV|             15376|             15376|             1863|             1845|\n+-------+-----------------+------------------+-------+------------------+------------------+-----------------+-----------------+"}], "metadata": {"collapsed": false}}, {"execution_count": 3, "cell_type": "code", "source": "flights.describe().select(\"summary\",\"ArrDelay\",\"DepDelay\").show()", "outputs": [{"output_type": "stream", "name": "stdout", "text": "+-------+-----------------+-----------------+\n|summary|         ArrDelay|         DepDelay|\n+-------+-----------------+-----------------+\n|  count|          2690385|          2691974|\n|   mean| 6.63768791455498|10.53686662649788|\n| stddev|38.64881489390021|36.09952806643081|\n|    min|              -94|              -63|\n|    max|             1845|             1863|\n+-------+-----------------+-----------------+"}], "metadata": {"collapsed": false}}, {"execution_count": 5, "cell_type": "code", "source": "flights.count() - flights.dropDuplicates().na.drop(\"any\",Array(\"ArrDelay\",\"DepDelay\")).count()", "outputs": [{"output_type": "stream", "name": "stdout", "text": "res5: Long = 46233"}], "metadata": {"collapsed": false}}, {"execution_count": 6, "cell_type": "code", "source": "val data = flights.dropDuplicates().na.fill(0,Array(\"ArrDelay\",\"DepDelay\"))\ndata.count()", "outputs": [{"output_type": "stream", "name": "stdout", "text": "res6: Long = 2696983"}], "metadata": {"collapsed": false}}, {"execution_count": 7, "cell_type": "code", "source": "data.createOrReplaceTempView(\"flightData\")", "outputs": [], "metadata": {"collapsed": true}}, {"execution_count": 7, "cell_type": "code", "source": "flights.show(50)", "outputs": [{"output_type": "stream", "name": "stdout", "text": "+----------+---------+-------+---------------+-------------+--------+--------+\n|DayofMonth|DayOfWeek|Carrier|OriginAirportID|DestAirportID|DepDelay|ArrDelay|\n+----------+---------+-------+---------------+-------------+--------+--------+\n|        19|        5|     DL|          11433|        13303|      -3|       1|\n|        19|        5|     DL|          14869|        12478|       0|      -8|\n|        19|        5|     DL|          14057|        14869|      -4|     -15|\n|        19|        5|     DL|          15016|        11433|      28|      24|\n|        19|        5|     DL|          11193|        12892|      -6|     -11|\n|        19|        5|     DL|          10397|        15016|      -1|     -19|\n|        19|        5|     DL|          15016|        10397|       0|      -1|\n|        19|        5|     DL|          10397|        14869|      15|      24|\n|        19|        5|     DL|          10397|        10423|      33|      34|\n|        19|        5|     DL|          11278|        10397|     323|     322|\n|        19|        5|     DL|          14107|        13487|      -7|     -13|\n|        19|        5|     DL|          11433|        11298|      22|      41|\n|        19|        5|     DL|          11298|        11433|      40|      20|\n|        19|        5|     DL|          11433|        12892|      -2|      -7|\n|        19|        5|     DL|          10397|        12451|      71|      75|\n|        19|        5|     DL|          12451|        10397|      75|      57|\n|        19|        5|     DL|          12953|        10397|      -1|      10|\n|        19|        5|     DL|          11433|        12953|      -3|     -10|\n|        19|        5|     DL|          10397|        14771|      31|      38|\n|        19|        5|     DL|          13204|        10397|       8|      25|\n|        19|        5|     DL|          13487|        12889|      -3|      -2|\n|        19|        5|     DL|          12889|        13487|       7|      16|\n|        19|        5|     DL|          10397|        14027|       0|      19|\n|        19|        5|     DL|          14027|        10397|      13|      25|\n|        19|        5|     DL|          13244|        10397|       4|      13|\n|        19|        5|     DL|          12953|        11697|      12|      -8|\n|        19|        5|     DL|          10397|        12892|      15|       7|\n|        19|        5|     DL|          14869|        14747|      -7|      -6|\n|        19|        5|     DL|          14747|        14869|      15|      18|\n|        19|        5|     DL|          10397|        10423|       0|      56|\n|        19|        5|     DL|          10423|        10397|      56|      49|\n|        20|        6|     DL|          11292|        12953|      -5|       6|\n|        20|        6|     DL|          14869|        14893|      -5|     -14|\n|        20|        6|     DL|          12953|        11697|      -3|      21|\n|        20|        6|     DL|          14869|        14908|      -6|     -14|\n|        20|        6|     DL|          12892|        15304|      21|      -2|\n|        20|        6|     DL|          10397|        11193|      16|      -2|\n|        20|        6|     DL|          10397|        11278|       2|       1|\n|        20|        6|     DL|          11278|        10397|      34|      38|\n|        20|        6|     DL|          10397|        13198|       5|      -6|\n|        20|        6|     DL|          13198|        10397|      -2|     -14|\n|        20|        6|     DL|          11057|        10397|      -1|     -13|\n|        20|        6|     DL|          11433|        13487|      -3|      -5|\n|        20|        6|     DL|          13487|        11433|      -8|     -13|\n|        20|        6|     DL|          12953|        10397|      -5|     -10|\n|        20|        6|     DL|          10397|        14100|      -6|     -27|\n|        20|        6|     DL|          14100|        10397|      -6|      14|\n|        20|        6|     DL|          12478|        10397|      -3|     -17|\n|        20|        6|     DL|          12889|        11433|      -3|     -10|\n|        20|        6|     DL|          10397|        14683|      -4|      -1|\n+----------+---------+-------+---------------+-------------+--------+--------+\nonly showing top 50 rows"}], "metadata": {"collapsed": false}}, {"execution_count": 12, "cell_type": "code", "source": "val airports = spark.read.option(\"inferSchema\",\"true\").option(\"header\",\"true\").csv(\"wasb:///data/airports.csv\")", "outputs": [{"output_type": "stream", "name": "stdout", "text": "airports: org.apache.spark.sql.DataFrame = [airport_id: int, city: string ... 2 more fields]"}], "metadata": {"collapsed": false}}, {"execution_count": 13, "cell_type": "code", "source": "airports.show()\n", "outputs": [{"output_type": "stream", "name": "stdout", "text": "+----------+-----------+-----+--------------------+\n|airport_id|       city|state|                name|\n+----------+-----------+-----+--------------------+\n|     10165|Adak Island|   AK|                Adak|\n|     10299|  Anchorage|   AK|Ted Stevens Ancho...|\n|     10304|      Aniak|   AK|       Aniak Airport|\n|     10754|     Barrow|   AK|Wiley Post/Will R...|\n|     10551|     Bethel|   AK|      Bethel Airport|\n|     10926|    Cordova|   AK|Merle K Mudhole S...|\n|     14709|  Deadhorse|   AK|   Deadhorse Airport|\n|     11336| Dillingham|   AK|  Dillingham Airport|\n|     11630|  Fairbanks|   AK|Fairbanks Interna...|\n|     11997|   Gustavus|   AK|    Gustavus Airport|\n|     12523|     Juneau|   AK|Juneau International|\n|     12819|  Ketchikan|   AK|Ketchikan Interna...|\n|     10245|King Salmon|   AK| King Salmon Airport|\n|     10170|     Kodiak|   AK|      Kodiak Airport|\n|     13970|   Kotzebue|   AK| Ralph Wien Memorial|\n|     13873|       Nome|   AK|        Nome Airport|\n|     14256| Petersburg|   AK|Petersburg James ...|\n|     14828|      Sitka|   AK|Sitka Rocky Gutie...|\n|     12807| St. Mary's|   AK|  St. Mary's Airport|\n|     11445|   Unalaska|   AK|    Unalaska Airport|\n+----------+-----------+-----+--------------------+\nonly showing top 20 rows"}], "metadata": {"collapsed": false}}, {"execution_count": 14, "cell_type": "code", "source": "airports.printSchema", "outputs": [{"output_type": "stream", "name": "stdout", "text": "root\n |-- airport_id: integer (nullable = true)\n |-- city: string (nullable = true)\n |-- state: string (nullable = true)\n |-- name: string (nullable = true)"}], "metadata": {"collapsed": false}}, {"execution_count": 15, "cell_type": "code", "source": "var cities = airports.select(\"city\",\"name\")", "outputs": [{"output_type": "stream", "name": "stdout", "text": "cities: org.apache.spark.sql.DataFrame = [city: string, name: string]"}], "metadata": {"collapsed": false}}, {"execution_count": 18, "cell_type": "code", "source": "cities.show(truncate = false)", "outputs": [{"output_type": "stream", "name": "stdout", "text": "+-----------+-----------------------------------+\n|city       |name                               |\n+-----------+-----------------------------------+\n|Adak Island|Adak                               |\n|Anchorage  |Ted Stevens Anchorage International|\n|Aniak      |Aniak Airport                      |\n|Barrow     |Wiley Post/Will Rogers Memorial    |\n|Bethel     |Bethel Airport                     |\n|Cordova    |Merle K Mudhole Smith              |\n|Deadhorse  |Deadhorse Airport                  |\n|Dillingham |Dillingham Airport                 |\n|Fairbanks  |Fairbanks International            |\n|Gustavus   |Gustavus Airport                   |\n|Juneau     |Juneau International               |\n|Ketchikan  |Ketchikan International            |\n|King Salmon|King Salmon Airport                |\n|Kodiak     |Kodiak Airport                     |\n|Kotzebue   |Ralph Wien Memorial                |\n|Nome       |Nome Airport                       |\n|Petersburg |Petersburg James A Johnson         |\n|Sitka      |Sitka Rocky Gutierrez              |\n|St. Mary's |St. Mary's Airport                 |\n|Unalaska   |Unalaska Airport                   |\n+-----------+-----------------------------------+\nonly showing top 20 rows"}], "metadata": {"collapsed": false}}, {"execution_count": 19, "cell_type": "code", "source": "var flightsByOrigin = flights.join(airports, $\"OriginAirportID\"===$\"airport_id\").groupBy(\"city\").count()\nflightsByOrigin.show()", "outputs": [{"output_type": "stream", "name": "stdout", "text": "+-----------------+------+\n|             city| count|\n+-----------------+------+\n|          Phoenix| 90281|\n|            Omaha| 13537|\n|   Raleigh/Durham| 28436|\n|        Anchorage|  7777|\n|           Dallas| 19503|\n|          Oakland| 25503|\n|      San Antonio| 23090|\n|     Philadelphia| 47659|\n|       Louisville| 10953|\n|      Los Angeles|118684|\n|Dallas/Fort Worth|105024|\n|       Sacramento| 25193|\n|     Indianapolis| 18099|\n|        Cleveland| 25261|\n|        San Diego| 45783|\n|    San Francisco| 84675|\n|        Nashville| 34927|\n|    Oklahoma City| 13967|\n|          Detroit| 62879|\n|         Portland| 30640|\n+-----------------+------+\nonly showing top 20 rows"}], "metadata": {"collapsed": false}}, {"execution_count": 20, "cell_type": "code", "source": "airports.createOrReplaceTempView(\"airportData\")\n#creating the view allows for using query lang", "outputs": [], "metadata": {"collapsed": true}}, {"execution_count": 22, "cell_type": "code", "source": "spark.sql(\"SELECT STATE, COUNT(*) AS AIRPORTS FROM airportData GROUP BY state ORDER BY state\").show()", "outputs": [{"output_type": "stream", "name": "stdout", "text": "+--------------------+--------+\n|               STATE|AIRPORTS|\n+--------------------+--------+\n|                  AK|      22|\n|                  AL|       5|\n|                  AR|       4|\n|                  AZ|       5|\n|                  CA|      32|\n|                  CO|      11|\n|                  CT|       2|\n|                  DC|       2|\n|                  DE|       1|\n|                  FL|      20|\n|Federated States ...|       1|\n|                  GA|       8|\n|                  HI|       7|\n|                  IA|       5|\n|                  ID|       6|\n|                  IL|       8|\n|                  IN|       4|\n|                  KS|       4|\n|                  KY|       3|\n|                  LA|       7|\n+--------------------+--------+\nonly showing top 20 rows"}], "metadata": {"collapsed": false}}, {"execution_count": 25, "cell_type": "code", "source": "%%sql\nSELECT airport_id, city, state, name\nFROM airportData", "outputs": [{"output_type": "stream", "name": "stderr", "text": "An internal error was encountered.\nPlease file an issue at https://github.com/jupyter-incubator/sparkmagic\nError:\n'LivySession' object has no attribute 'sql_context_variable_name'\n"}], "metadata": {"scrolled": false, "collapsed": false}}, {"execution_count": 8, "cell_type": "code", "source": "%%sql\nSELECT DepDelay, ArrDelay FROM flightData", "outputs": [{"ename": "AttributeError", "evalue": "'module' object has no attribute 'api'", "traceback": ["\u001b[1;31m\u001b[0m", "\u001b[1;31mAttributeError\u001b[0mTraceback (most recent call last)", "\u001b[1;32m/usr/bin/anaconda/lib/python2.7/site-packages/IPython/core/formatters.pyc\u001b[0m in \u001b[0;36m__call__\u001b[1;34m(self, obj)\u001b[0m\n\u001b[0;32m    902\u001b[0m                 \u001b[1;32mpass\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    903\u001b[0m             \u001b[1;32melse\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 904\u001b[1;33m                 \u001b[0mprinter\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mobj\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    905\u001b[0m                 \u001b[1;32mreturn\u001b[0m \u001b[0mTrue\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    906\u001b[0m             \u001b[1;31m# Finally look for special method names\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n", "\u001b[1;32m/usr/bin/anaconda/lib/python2.7/site-packages/autovizwidget/widget/utils.pyc\u001b[0m in \u001b[0;36mdisplay_dataframe\u001b[1;34m(df)\u001b[0m\n\u001b[0;32m    114\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    115\u001b[0m \u001b[1;32mdef\u001b[0m \u001b[0mdisplay_dataframe\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mdf\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 116\u001b[1;33m     \u001b[0mselected_x\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mselect_x\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mdf\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    117\u001b[0m     \u001b[0mselected_y\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mselect_y\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mdf\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mselected_x\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    118\u001b[0m     encoding = Encoding(chart_type=Encoding.chart_type_table, x=selected_x, y=selected_y,\n", "\u001b[1;32m/usr/bin/anaconda/lib/python2.7/site-packages/autovizwidget/widget/utils.pyc\u001b[0m in \u001b[0;36mselect_x\u001b[1;34m(data, order)\u001b[0m\n\u001b[0;32m     70\u001b[0m         \u001b[0m_validate_custom_order\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0morder\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     71\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 72\u001b[1;33m     \u001b[0md\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0m_classify_data_by_type\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0morder\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m     73\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     74\u001b[0m     \u001b[0mchosen_x\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mNone\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n", "\u001b[1;32m/usr/bin/anaconda/lib/python2.7/site-packages/autovizwidget/widget/utils.pyc\u001b[0m in \u001b[0;36m_classify_data_by_type\u001b[1;34m(data, order, skip)\u001b[0m\n\u001b[0;32m     48\u001b[0m     \u001b[1;32mfor\u001b[0m \u001b[0mcolumn_name\u001b[0m \u001b[1;32min\u001b[0m \u001b[0mdata\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     49\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[0mcolumn_name\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32min\u001b[0m \u001b[0mskip\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 50\u001b[1;33m             \u001b[0mtyp\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0minfer_vegalite_type\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mcolumn_name\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m     51\u001b[0m             \u001b[0md\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mtyp\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mcolumn_name\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     52\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n", "\u001b[1;32m/usr/bin/anaconda/lib/python2.7/site-packages/autovizwidget/widget/utils.pyc\u001b[0m in \u001b[0;36minfer_vegalite_type\u001b[1;34m(data)\u001b[0m\n\u001b[0;32m     14\u001b[0m     \"\"\"\n\u001b[0;32m     15\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 16\u001b[1;33m     \u001b[0mtyp\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mpd\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mapi\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mtypes\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0minfer_dtype\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m     17\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     18\u001b[0m     if typ in ['floating', 'mixed-integer-float', 'integer',\n", "\u001b[1;31mAttributeError\u001b[0m: 'module' object has no attribute 'api'"], "output_type": "error"}, {"execution_count": 8, "output_type": "execute_result", "data": {"text/plain": "      DepDelay  ArrDelay\n0            1         3\n1            1        -2\n2           -3       -12\n3           85        95\n4           -2       -17\n5           -5        -3\n6           -1       -18\n7           -2        -6\n8           -5         2\n9           -3       -16\n10          -1        -2\n11          -5       -10\n12          -6        -2\n13          21        16\n14         -14       -17\n15          -6       -22\n16          -3       -10\n17           6        -1\n18           0        10\n19          -2        -6\n20          -4       -13\n21          -5       -15\n22          21       -13\n23           0        -7\n24          -7       -10\n25          -3       -17\n26         -10       -28\n27          10       -12\n28          -6       -15\n29          -4        -2\n...        ...       ...\n2470        -5         4\n2471         0        -8\n2472        -6       -47\n2473        21        14\n2474         9        -1\n2475         0        12\n2476       -10        19\n2477        15         1\n2478         3        -3\n2479         2        -2\n2480        -4       -19\n2481        -9       -10\n2482        -1       -21\n2483        76        77\n2484        -8        -2\n2485        -5       -24\n2486        -2         6\n2487        -3       -10\n2488         0         3\n2489        -2        -9\n2490        -2       -23\n2491        -6        -4\n2492        40        23\n2493         4         4\n2494        94        91\n2495        -7       -16\n2496        -4        -3\n2497        -6         0\n2498        91        74\n2499        -2       -21\n\n[2500 rows x 2 columns]", "text/html": "<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>DepDelay</th>\n      <th>ArrDelay</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>-2</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>-3</td>\n      <td>-12</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>85</td>\n      <td>95</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>-2</td>\n      <td>-17</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>-5</td>\n      <td>-3</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>-1</td>\n      <td>-18</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>-2</td>\n      <td>-6</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>-5</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>-3</td>\n      <td>-16</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>-1</td>\n      <td>-2</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>-5</td>\n      <td>-10</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>-6</td>\n      <td>-2</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>21</td>\n      <td>16</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>-14</td>\n      <td>-17</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>-6</td>\n      <td>-22</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>-3</td>\n      <td>-10</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>6</td>\n      <td>-1</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>0</td>\n      <td>10</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>-2</td>\n      <td>-6</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>-4</td>\n      <td>-13</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>-5</td>\n      <td>-15</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>21</td>\n      <td>-13</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>0</td>\n      <td>-7</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>-7</td>\n      <td>-10</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>-3</td>\n      <td>-17</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>-10</td>\n      <td>-28</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>10</td>\n      <td>-12</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>-6</td>\n      <td>-15</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>-4</td>\n      <td>-2</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>2470</th>\n      <td>-5</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>2471</th>\n      <td>0</td>\n      <td>-8</td>\n    </tr>\n    <tr>\n      <th>2472</th>\n      <td>-6</td>\n      <td>-47</td>\n    </tr>\n    <tr>\n      <th>2473</th>\n      <td>21</td>\n      <td>14</td>\n    </tr>\n    <tr>\n      <th>2474</th>\n      <td>9</td>\n      <td>-1</td>\n    </tr>\n    <tr>\n      <th>2475</th>\n      <td>0</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>2476</th>\n      <td>-10</td>\n      <td>19</td>\n    </tr>\n    <tr>\n      <th>2477</th>\n      <td>15</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2478</th>\n      <td>3</td>\n      <td>-3</td>\n    </tr>\n    <tr>\n      <th>2479</th>\n      <td>2</td>\n      <td>-2</td>\n    </tr>\n    <tr>\n      <th>2480</th>\n      <td>-4</td>\n      <td>-19</td>\n    </tr>\n    <tr>\n      <th>2481</th>\n      <td>-9</td>\n      <td>-10</td>\n    </tr>\n    <tr>\n      <th>2482</th>\n      <td>-1</td>\n      <td>-21</td>\n    </tr>\n    <tr>\n      <th>2483</th>\n      <td>76</td>\n      <td>77</td>\n    </tr>\n    <tr>\n      <th>2484</th>\n      <td>-8</td>\n      <td>-2</td>\n    </tr>\n    <tr>\n      <th>2485</th>\n      <td>-5</td>\n      <td>-24</td>\n    </tr>\n    <tr>\n      <th>2486</th>\n      <td>-2</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>2487</th>\n      <td>-3</td>\n      <td>-10</td>\n    </tr>\n    <tr>\n      <th>2488</th>\n      <td>0</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>2489</th>\n      <td>-2</td>\n      <td>-9</td>\n    </tr>\n    <tr>\n      <th>2490</th>\n      <td>-2</td>\n      <td>-23</td>\n    </tr>\n    <tr>\n      <th>2491</th>\n      <td>-6</td>\n      <td>-4</td>\n    </tr>\n    <tr>\n      <th>2492</th>\n      <td>40</td>\n      <td>23</td>\n    </tr>\n    <tr>\n      <th>2493</th>\n      <td>4</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>2494</th>\n      <td>94</td>\n      <td>91</td>\n    </tr>\n    <tr>\n      <th>2495</th>\n      <td>-7</td>\n      <td>-16</td>\n    </tr>\n    <tr>\n      <th>2496</th>\n      <td>-4</td>\n      <td>-3</td>\n    </tr>\n    <tr>\n      <th>2497</th>\n      <td>-6</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2498</th>\n      <td>91</td>\n      <td>74</td>\n    </tr>\n    <tr>\n      <th>2499</th>\n      <td>-2</td>\n      <td>-21</td>\n    </tr>\n  </tbody>\n</table>\n<p>2500 rows \u00d7 2 columns</p>\n</div>"}, "metadata": {}}], "metadata": {"collapsed": false}}, {"execution_count": null, "cell_type": "code", "source": "", "outputs": [], "metadata": {"collapsed": true}}], "nbformat": 4, "metadata": {"kernelspec": {"display_name": "Spark", "name": "sparkkernel", "language": ""}, "language_info": {"mimetype": "text/x-scala", "pygments_lexer": "scala", "name": "scala", "codemirror_mode": "text/x-scala"}}}